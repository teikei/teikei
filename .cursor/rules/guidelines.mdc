---
description: 
globs: 
alwaysApply: true
---
# Project Guidelines

## 1. Monorepo Structure

- The workspace uses a monorepo with multiple packages: `admin` (React frontend), `api` (Node.js backend), and `map` (React frontend).
- Each package has its own `package.json`, configuration, and source directories.

## 2. About the project.

- Teikei is a web application and API that maps out community-supported agriculture in Germany, Switzerland, and Austria, based on crowdsourced data.
- Refer to README.md in the same directory for more information.
- The frontend project `map` is in a process of modernization:
  - legacy SCSS styles will be replaced by Tailwind
  - forms will be re-implemented with react-hook-form and shadcn components

## 3. Coding Standards

- Use ESLint for JavaScript/TypeScript linting. Follow the rules defined in `eslint.config.js`.
- Use Prettier formatting conventions where applicable.
- Write clear, descriptive commit messages.

## 4. Frontend (`admin`/`map`)

- Use React (TSX) for UI components.
- Organize components under `src/components`.
- Use TypeScript for new files where possible.
- Place assets in `src/assets` or `public/assets`.
- Use Vite for development and builds.
- Store styles in `src/styles` or as CSS modules.

## 5. Backend (`api`)

- Use Node.js with Feathers.js for the API.
- Organize services under `src/services`.
- Use Knex for database migrations and seeds (see `db/migrations` and `db/seeds`).
- Store configuration in `config/` with environment-specific files.
- Write tests in the appropriate `test` or `__tests__` directories.

## 6. Testing

- Use Jest for backend tests (`api`).
- Use Playwright for frontend end-to-end tests (`map`).
- Place test files alongside source files or in dedicated test directories.
- Ensure new features include relevant tests.

## 7. Environment & Deployment

- Use environment variables as defined in `config/custom-environment-variables.json`.
- Use `deploy_all.sh` for deployment automation.
- Keep secrets and sensitive data out of version control.

## 8. Documentation

- Update `README.md` and `CONTRIBUTING.md` with any significant changes.
- Document new components, services, and utilities.

## 9. General Best Practices

- Reuse existing components and utilities where possible.
- Keep code modular and maintainable.
- Follow the existing folder structure and naming conventions.
- Review and test changes before merging.

## 10. Running & Testing the Project

- Install dependencies in the respective package (packages/map, packages/api or packages/admin).
- Don't install packages specific packages in the root folder, except global tools e.g. for monorepo
  management. 
- To run the frontend (`map`), use `npm run dev` from the root directory.
- To run the admin frontend (`admin`), use `npm run dev-admin` from the root directory.
- For end-to-end tests (frontend), use `npm run webtests` from the root directory.
- For backend tests, use `npm test` in the `api` package.
